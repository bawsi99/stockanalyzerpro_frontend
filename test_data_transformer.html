<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Transformer Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
            font-weight: bold;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        .field-test {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #ddd;
        }
        .field-test.success {
            border-left-color: #28a745;
        }
        .field-test.error {
            border-left-color: #dc3545;
        }
    </style>
</head>
<body>
    <h1>ðŸ”§ Data Transformer Test</h1>
    <p>This page tests the frontend data transformer to ensure all backend-frontend data mismatches are resolved.</p>

    <div class="container">
        <h2>Test Results</h2>
        <div id="test-results"></div>
    </div>

    <div class="container">
        <h2>Sample Data</h2>
        <div id="sample-data"></div>
    </div>

    <script type="module">
        // Mock the data transformer functions for testing
        function mockTransformDatabaseRecord(record) {
            const analysisData = record.analysis_data;
            
            return {
                consensus: extractConsensus(analysisData),
                indicators: extractIndicators(analysisData),
                charts: extractCharts(analysisData),
                ai_analysis: extractAIAnalysis(analysisData),
                indicator_summary_md: extractIndicatorSummary(analysisData),
                chart_insights: extractChartInsights(analysisData),
                sector_benchmarking: extractSectorBenchmarking(analysisData),
                summary: extractSummary(analysisData),
                support_levels: extractSupportLevels(analysisData),
                resistance_levels: extractResistanceLevels(analysisData),
                triangle_patterns: extractTrianglePatterns(analysisData),
                flag_patterns: extractFlagPatterns(analysisData),
                volume_anomalies_detailed: extractVolumeAnomalies(analysisData),
                overlays: extractOverlays(analysisData),
                trading_guidance: extractTradingGuidance(analysisData),
                multi_timeframe_analysis: extractMultiTimeframeAnalysis(analysisData)
            };
        }

        function extractConsensus(data) {
            const summary = data.summary || {};
            const aiAnalysis = data.ai_analysis || {};
            
            return {
                overall_signal: summary.overall_signal || aiAnalysis.trend || 'Neutral',
                signal_strength: summary.analysis_quality || 'Medium',
                bullish_percentage: calculateBullishPercentage(data),
                bearish_percentage: calculateBearishPercentage(data),
                neutral_percentage: calculateNeutralPercentage(data),
                bullish_score: 0,
                bearish_score: 0,
                neutral_score: 0,
                total_weight: 100,
                confidence: summary.confidence || aiAnalysis.confidence_pct || 0,
                signal_details: [],
                data_quality_flags: [],
                warnings: extractWarnings(data),
                bullish_count: 0,
                bearish_count: 0,
                neutral_count: 0
            };
        }

        function extractIndicators(data) {
            const indicators = data.indicators || {};
            
            return {
                moving_averages: {
                    sma_20: indicators.moving_averages?.sma_20 || 0,
                    sma_50: indicators.moving_averages?.sma_50 || 0,
                    sma_200: indicators.moving_averages?.sma_200 || 0,
                    ema_20: indicators.moving_averages?.ema_20 || 0,
                    ema_50: indicators.moving_averages?.ema_50 || 0,
                    price_to_sma_200: indicators.moving_averages?.price_to_sma_200 || 0,
                    sma_20_to_sma_50: indicators.moving_averages?.sma_20_to_sma_50 || 0,
                    golden_cross: indicators.moving_averages?.golden_cross || false,
                    death_cross: indicators.moving_averages?.death_cross || false
                },
                rsi: {
                    rsi_14: indicators.rsi?.rsi_14 || 0,
                    trend: indicators.rsi?.trend || 'Neutral',
                    status: indicators.rsi?.status || 'Neutral'
                },
                macd: {
                    macd_line: indicators.macd?.macd_line || 0,
                    signal_line: indicators.macd?.signal_line || 0,
                    histogram: indicators.macd?.histogram || 0
                },
                bollinger_bands: {
                    upper_band: indicators.bollinger_bands?.upper_band || indicators.bollinger_bands?.upper || 0,
                    middle_band: indicators.bollinger_bands?.middle_band || indicators.bollinger_bands?.middle || 0,
                    lower_band: indicators.bollinger_bands?.lower_band || indicators.bollinger_bands?.lower || 0,
                    percent_b: indicators.bollinger_bands?.percent_b || 0,
                    bandwidth: indicators.bollinger_bands?.bandwidth || 0
                },
                volume: {
                    volume_ratio: indicators.volume?.volume_ratio || 0,
                    obv: indicators.volume?.obv || 0,
                    obv_trend: indicators.volume?.obv_trend || 'Neutral'
                },
                adx: {
                    adx: indicators.adx?.adx || 0,
                    plus_di: indicators.adx?.plus_di || 0,
                    minus_di: indicators.adx?.minus_di || 0,
                    trend_direction: indicators.adx?.trend_direction || 'Neutral'
                },
                trend_data: {
                    direction: indicators.trend_data?.direction || 'Neutral',
                    strength: indicators.trend_data?.strength || 'Weak',
                    adx: indicators.trend_data?.adx || 0,
                    plus_di: indicators.trend_data?.plus_di || 0,
                    minus_di: indicators.trend_data?.minus_di || 0
                },
                raw_data: {
                    open: [],
                    high: [],
                    low: [],
                    close: [],
                    volume: []
                },
                advanced_patterns: data.overlays?.advanced_patterns || null,
                advanced_risk: data.indicators?.advanced_risk_metrics || null,
                stress_testing: data.indicators?.stress_testing_metrics || null,
                scenario_analysis: data.indicators?.scenario_analysis_metrics || null,
                metadata: {
                    start: data.metadata?.analysis_date || '',
                    end: data.metadata?.analysis_date || '',
                    period: data.metadata?.period_days || data.metadata?.data_period?.split(' ')[0] || 365,
                    last_price: 0,
                    last_volume: 0,
                    data_quality: {
                        is_valid: true,
                        warnings: [],
                        data_quality_issues: [],
                        missing_data: [],
                        suspicious_patterns: []
                    },
                    indicator_availability: {
                        sma_20: true,
                        sma_50: true,
                        sma_200: true,
                        ema_20: true,
                        ema_50: true,
                        macd: true,
                        rsi: true,
                        bollinger_bands: true,
                        stochastic: true,
                        adx: true,
                        obv: true,
                        volume_ratio: true,
                        atr: true
                    },
                    multi_timeframe: data.multi_timeframe_analysis || null
                }
            };
        }

        function extractAIAnalysis(data) {
            const aiAnalysis = data.ai_analysis || {};
            const summary = data.summary || {};
            
            return {
                meta: {
                    symbol: data.metadata?.symbol || '',
                    analysis_date: data.metadata?.analysis_date || '',
                    timeframe: data.metadata?.interval || 'day',
                    overall_confidence: summary.confidence || aiAnalysis.confidence_pct || 0,
                    data_quality_score: 85
                },
                market_outlook: {
                    primary_trend: {
                        direction: aiAnalysis.trend || 'Neutral',
                        strength: summary.analysis_quality || 'Medium',
                        duration: 'Medium-term',
                        confidence: summary.confidence || 0,
                        rationale: 'Based on technical analysis'
                    },
                    secondary_trend: {
                        direction: 'Neutral',
                        strength: 'Weak',
                        duration: 'Short-term',
                        confidence: 0,
                        rationale: 'Secondary trend analysis'
                    },
                    key_drivers: []
                },
                trading_strategy: {
                    short_term: extractTimeframeStrategy(aiAnalysis.short_term),
                    medium_term: extractTimeframeStrategy(aiAnalysis.medium_term),
                    long_term: {
                        horizon_days: 365,
                        investment_rating: summary.recommendation || 'Hold',
                        fair_value_range: [0, 0],
                        rationale: 'Long-term analysis'
                    }
                },
                risk_management: {
                    key_risks: extractRisks(aiAnalysis.risks),
                    stop_loss_levels: [],
                    position_management: {
                        scaling_in: false,
                        scaling_out: false,
                        max_correlation: 0.7
                    }
                },
                critical_levels: {
                    must_watch: extractCriticalLevels(aiAnalysis.must_watch_levels),
                    confirmation_levels: []
                },
                monitoring_plan: {
                    daily_checks: [],
                    weekly_reviews: [],
                    exit_triggers: []
                },
                data_quality_assessment: {
                    issues: [],
                    confidence_adjustments: {
                        reason: '',
                        adjustment: ''
                    }
                },
                key_takeaways: [],
                indicator_summary_md: data.indicator_summary_md || '',
                chart_insights: data.chart_insights || ''
            };
        }

        function extractTradingGuidance(data) {
            return data.trading_guidance || null;
        }

        function extractMultiTimeframeAnalysis(data) {
            return data.multi_timeframe_analysis || null;
        }

        function extractSectorBenchmarking(data) {
            return data.sector_benchmarking || null;
        }

        function extractSummary(data) {
            const summary = data.summary || {};
            const aiAnalysis = data.ai_analysis || {};
            
            return {
                overall_signal: summary.overall_signal || aiAnalysis.trend || 'Neutral',
                signal_strength: summary.analysis_quality || 'Medium',
                bullish_percentage: calculateBullishPercentage(data),
                bearish_percentage: calculateBearishPercentage(data),
                neutral_percentage: calculateNeutralPercentage(data)
            };
        }

        function extractOverlays(data) {
            const overlays = data.overlays || {};
            
            return {
                triangles: overlays.triangles || [],
                flags: overlays.flags || [],
                support_resistance: overlays.support_resistance || { support: [], resistance: [] },
                double_tops: overlays.double_tops || [],
                double_bottoms: overlays.double_bottoms || [],
                divergences: overlays.divergences || [],
                volume_anomalies: overlays.volume_anomalies || []
            };
        }

        function extractIndicatorSummary(data) {
            return data.indicator_summary_md || '';
        }

        function extractChartInsights(data) {
            return data.chart_insights || '';
        }

        function extractSupportLevels(data) {
            const overlays = data.overlays || {};
            const supportResistance = overlays.support_resistance || {};
            return (supportResistance.support || []).map(s => s.level || 0);
        }

        function extractResistanceLevels(data) {
            const overlays = data.overlays || {};
            const supportResistance = overlays.support_resistance || {};
            return (supportResistance.resistance || []).map(r => r.level || 0);
        }

        function extractTrianglePatterns(data) {
            return data.overlays?.triangles || [];
        }

        function extractFlagPatterns(data) {
            return data.overlays?.flags || [];
        }

        function extractVolumeAnomalies(data) {
            return data.overlays?.volume_anomalies || [];
        }

        function extractCharts(data) {
            return {
                comparison_chart: {},
                divergence: {},
                double_tops_bottoms: {},
                support_resistance: {},
                triangles_flags: {},
                volume_anomalies: {}
            };
        }

        function calculateBullishPercentage(data) {
            const summary = data.summary || {};
            const aiAnalysis = data.ai_analysis || {};
            
            if (summary.overall_signal === 'Bullish' || aiAnalysis.trend === 'Bullish') {
                return summary.confidence || aiAnalysis.confidence_pct || 50;
            }
            return 0;
        }

        function calculateBearishPercentage(data) {
            const summary = data.summary || {};
            const aiAnalysis = data.ai_analysis || {};
            
            if (summary.overall_signal === 'Bearish' || aiAnalysis.trend === 'Bearish') {
                return summary.confidence || aiAnalysis.confidence_pct || 50;
            }
            return 0;
        }

        function calculateNeutralPercentage(data) {
            const bullish = calculateBullishPercentage(data);
            const bearish = calculateBearishPercentage(data);
            return Math.max(0, 100 - bullish - bearish);
        }

        function extractWarnings(data) {
            const aiAnalysis = data.ai_analysis || {};
            return aiAnalysis.risks || [];
        }

        function extractTimeframeStrategy(timeframeData) {
            if (!timeframeData) {
                return {
                    horizon_days: 30,
                    bias: 'Neutral',
                    entry_strategy: { type: '', entry_range: [null, null], entry_conditions: [], confidence: 0 },
                    exit_strategy: { stop_loss: 0, stop_loss_type: '', targets: [], trailing_stop: { enabled: false, method: null } },
                    position_sizing: { risk_per_trade: '', max_position_size: '', atr_multiplier: null },
                    rationale: ''
                };
            }
            
            return {
                horizon_days: timeframeData.horizon_days || 30,
                bias: timeframeData.signal || 'Neutral',
                entry_strategy: {
                    type: 'Standard',
                    entry_range: [timeframeData.entry_range_min || null, timeframeData.entry_range_max || null],
                    entry_conditions: [],
                    confidence: timeframeData.confidence || 0
                },
                exit_strategy: {
                    stop_loss: timeframeData.stop_loss || 0,
                    stop_loss_type: 'Fixed',
                    targets: [timeframeData.target_1 || 0, timeframeData.target_2 || 0],
                    trailing_stop: { enabled: false, method: null }
                },
                position_sizing: {
                    risk_per_trade: '2%',
                    max_position_size: '10%',
                    atr_multiplier: null
                },
                rationale: timeframeData.rationale || ''
            };
        }

        function extractRisks(risks) {
            if (!Array.isArray(risks)) return [];
            
            return risks.map(risk => ({
                risk: typeof risk === 'string' ? risk : 'Unknown risk',
                probability: 'Medium',
                impact: 'Medium',
                mitigation: 'Monitor closely'
            }));
        }

        function extractCriticalLevels(levels) {
            if (!Array.isArray(levels)) return [];
            
            return levels.map(level => ({
                level: typeof level === 'string' ? parseFloat(level) || 0 : level,
                type: 'Support/Resistance',
                significance: 'High',
                action: 'Monitor'
            }));
        }

        // Test data that simulates the backend response
        const testRecord = {
            id: 'test-123',
            user_id: 'user-456',
            stock_symbol: 'RELIANCE',
            analysis_data: {
                ai_analysis: {
                    trend: 'Bullish',
                    confidence_pct: 75,
                    short_term: {
                        horizon_days: 30,
                        signal: 'Bullish',
                        entry_range_min: 1500,
                        entry_range_max: 1550,
                        stop_loss: 1450,
                        target_1: 1600,
                        target_2: 1650,
                        confidence: 75,
                        rationale: 'Strong technical momentum'
                    },
                    medium_term: {
                        horizon_days: 90,
                        signal: 'Bullish',
                        entry_range_min: 1480,
                        entry_range_max: 1580,
                        stop_loss: 1400,
                        target_1: 1700,
                        target_2: 1800,
                        confidence: 70,
                        rationale: 'Sector rotation favor'
                    },
                    long_term: {
                        horizon_days: 365,
                        signal: 'Neutral',
                        entry_range_min: 1400,
                        entry_range_max: 1600,
                        stop_loss: 1300,
                        target_1: 1800,
                        target_2: 2000,
                        confidence: 60,
                        rationale: 'Long-term growth potential'
                    },
                    risks: [
                        'Market volatility risk',
                        'Sector-specific risks',
                        'Liquidity risk'
                    ],
                    must_watch_levels: [
                        '1500 - Strong support',
                        '1600 - Resistance level',
                        '1700 - Breakout target'
                    ]
                },
                indicators: {
                    bollinger_bands: {
                        upper_band: 1550.0,
                        middle_band: 1500.0,
                        lower_band: 1450.0,
                        percent_b: 0.5,
                        bandwidth: 0.067
                    },
                    moving_averages: {
                        sma_20: 1510.0,
                        sma_50: 1490.0,
                        sma_200: 1450.0,
                        ema_20: 1515.0,
                        ema_50: 1495.0,
                        price_to_sma_200: 0.034,
                        sma_20_to_sma_50: 0.013,
                        golden_cross: true,
                        death_cross: false
                    },
                    rsi: {
                        rsi_14: 65.0,
                        trend: 'up',
                        status: 'near_overbought'
                    },
                    macd: {
                        macd_line: 5.0,
                        signal_line: 3.0,
                        histogram: 2.0
                    },
                    volume: {
                        volume_ratio: 1.2,
                        obv: 1000000,
                        obv_trend: 'up'
                    },
                    adx: {
                        adx: 25.0,
                        plus_di: 30.0,
                        minus_di: 20.0,
                        trend_direction: 'bullish'
                    },
                    trend_data: {
                        direction: 'bullish',
                        strength: 'strong',
                        adx: 25.0,
                        plus_di: 30.0,
                        minus_di: 20.0
                    }
                },
                trading_guidance: {
                    short_term: {
                        horizon_days: 30,
                        signal: 'Bullish',
                        entry_range_min: 1500,
                        entry_range_max: 1550,
                        stop_loss: 1450,
                        target_1: 1600,
                        target_2: 1650,
                        confidence: 75,
                        rationale: 'Strong technical momentum'
                    },
                    medium_term: {
                        horizon_days: 90,
                        signal: 'Bullish',
                        entry_range_min: 1480,
                        entry_range_max: 1580,
                        stop_loss: 1400,
                        target_1: 1700,
                        target_2: 1800,
                        confidence: 70,
                        rationale: 'Sector rotation favor'
                    },
                    long_term: {
                        horizon_days: 365,
                        signal: 'Neutral',
                        entry_range_min: 1400,
                        entry_range_max: 1600,
                        stop_loss: 1300,
                        target_1: 1800,
                        target_2: 2000,
                        confidence: 60,
                        rationale: 'Long-term growth potential'
                    },
                    risk_management: [
                        'Market volatility risk',
                        'Sector-specific risks',
                        'Liquidity risk'
                    ],
                    key_levels: [
                        '1500 - Strong support',
                        '1600 - Resistance level',
                        '1700 - Breakout target'
                    ]
                },
                multi_timeframe_analysis: {
                    short_term: {
                        name: 'Short Term',
                        periods: {
                            '1d': { trend: 'bullish', strength: 0.7 },
                            '1w': { trend: 'bullish', strength: 0.6 },
                            '1m': { trend: 'neutral', strength: 0.5 }
                        },
                        ai_confidence: 75,
                        ai_trend: 'bullish',
                        consensus: {
                            direction: 'bullish',
                            strength: 0.6,
                            score: 7.5,
                            timeframe_alignment: { '1d': 'bullish', '1w': 'bullish', '1m': 'neutral' },
                            bullish_periods: 2,
                            bearish_periods: 0,
                            neutral_periods: 1
                        }
                    },
                    medium_term: {
                        name: 'Medium Term',
                        periods: {
                            '1m': { trend: 'bullish', strength: 0.6 },
                            '3m': { trend: 'bullish', strength: 0.5 },
                            '6m': { trend: 'neutral', strength: 0.4 }
                        },
                        ai_confidence: 70,
                        ai_trend: 'bullish',
                        consensus: {
                            direction: 'bullish',
                            strength: 0.5,
                            score: 7.0,
                            timeframe_alignment: { '1m': 'bullish', '3m': 'bullish', '6m': 'neutral' },
                            bullish_periods: 2,
                            bearish_periods: 0,
                            neutral_periods: 1
                        }
                    },
                    long_term: {
                        name: 'Long Term',
                        periods: {
                            '6m': { trend: 'neutral', strength: 0.4 },
                            '1y': { trend: 'neutral', strength: 0.3 },
                            '2y': { trend: 'bullish', strength: 0.5 }
                        },
                        ai_confidence: 60,
                        ai_trend: 'neutral',
                        consensus: {
                            direction: 'neutral',
                            strength: 0.4,
                            score: 6.0,
                            timeframe_alignment: { '6m': 'neutral', '1y': 'neutral', '2y': 'bullish' },
                            bullish_periods: 1,
                            bearish_periods: 0,
                            neutral_periods: 2
                        }
                    },
                    overall_consensus: {
                        direction: 'bullish',
                        strength: 0.5,
                        score: 6.8,
                        timeframe_alignment: {
                            short_term: 'bullish',
                            medium_term: 'bullish',
                            long_term: 'neutral'
                        }
                    }
                },
                metadata: {
                    symbol: 'RELIANCE',
                    exchange: 'NSE',
                    analysis_date: new Date().toISOString(),
                    data_period: '365 days',
                    period_days: 365,
                    interval: 'day',
                    sector: 'Oil & Gas'
                },
                summary: {
                    overall_signal: 'Bullish',
                    confidence: 75,
                    analysis_method: 'AI-Powered Analysis',
                    analysis_quality: 'High',
                    risk_level: 'Medium',
                    recommendation: 'Buy'
                },
                indicator_summary_md: 'Technical analysis shows strong bullish momentum...',
                chart_insights: 'Chart patterns indicate continued upward movement...',
                overlays: {
                    triangles: [],
                    flags: [],
                    support_resistance: { support: [{ level: 1500 }], resistance: [{ level: 1600 }] },
                    double_tops: [],
                    double_bottoms: [],
                    divergences: [],
                    volume_anomalies: []
                }
            },
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };

        // Run tests
        function runTests() {
            const results = [];
            
            try {
                // Test 1: Transform the record
                const transformed = mockTransformDatabaseRecord(testRecord);
                results.push({ test: 'Data Transformation', status: 'success', message: 'Record transformed successfully' });

                // Test 2: Check Bollinger Bands field names
                const bb = transformed.indicators.bollinger_bands;
                if (bb.upper_band && bb.middle_band && bb.lower_band) {
                    results.push({ test: 'Bollinger Bands Fields', status: 'success', message: 'Correct field names: upper_band, middle_band, lower_band' });
                } else {
                    results.push({ test: 'Bollinger Bands Fields', status: 'error', message: 'Missing required Bollinger Bands fields' });
                }

                // Test 3: Check metadata period
                const metadata = transformed.indicators.metadata;
                if (metadata.period === 365) {
                    results.push({ test: 'Metadata Period', status: 'success', message: 'Period correctly extracted: ' + metadata.period });
                } else {
                    results.push({ test: 'Metadata Period', status: 'error', message: 'Period extraction failed: ' + metadata.period });
                }

                // Test 4: Check trading guidance
                if (transformed.trading_guidance && transformed.trading_guidance.short_term) {
                    results.push({ test: 'Trading Guidance', status: 'success', message: 'Trading guidance extracted successfully' });
                } else {
                    results.push({ test: 'Trading Guidance', status: 'error', message: 'Trading guidance extraction failed' });
                }

                // Test 5: Check multi-timeframe analysis
                if (transformed.multi_timeframe_analysis && transformed.multi_timeframe_analysis.short_term) {
                    results.push({ test: 'Multi-timeframe Analysis', status: 'success', message: 'Multi-timeframe analysis extracted successfully' });
                } else {
                    results.push({ test: 'Multi-timeframe Analysis', status: 'error', message: 'Multi-timeframe analysis extraction failed' });
                }

                // Test 6: Check indicators metadata multi_timeframe
                if (metadata.multi_timeframe && metadata.multi_timeframe.short_term) {
                    results.push({ test: 'Indicators Multi-timeframe', status: 'success', message: 'Multi-timeframe added to indicators metadata' });
                } else {
                    results.push({ test: 'Indicators Multi-timeframe', status: 'error', message: 'Multi-timeframe not added to indicators metadata' });
                }

                // Test 7: Check advanced fields
                if (transformed.indicators.advanced_patterns !== undefined) {
                    results.push({ test: 'Advanced Fields', status: 'success', message: 'Advanced fields added with fallbacks' });
                } else {
                    results.push({ test: 'Advanced Fields', status: 'error', message: 'Advanced fields missing' });
                }

                // Display results
                displayResults(results);
                displaySampleData(transformed);

            } catch (error) {
                results.push({ test: 'General', status: 'error', message: 'Test failed with error: ' + error.message });
                displayResults(results);
            }
        }

        function displayResults(results) {
            const container = document.getElementById('test-results');
            let html = '';

            results.forEach(result => {
                const statusClass = result.status === 'success' ? 'success' : 'error';
                html += `
                    <div class="field-test ${statusClass}">
                        <strong>${result.test}:</strong> ${result.message}
                    </div>
                `;
            });

            const passed = results.filter(r => r.status === 'success').length;
            const total = results.length;
            
            html = `
                <div class="info">
                    ðŸ“Š Test Results: ${passed}/${total} tests passed
                </div>
                ${html}
            `;

            container.innerHTML = html;
        }

        function displaySampleData(transformed) {
            const container = document.getElementById('sample-data');
            container.innerHTML = `
                <h3>Transformed Data Sample</h3>
                <pre>${JSON.stringify(transformed, null, 2)}</pre>
            `;
        }

        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html> 